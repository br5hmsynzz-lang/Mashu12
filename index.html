<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M12 Animated Puzzle</title>
    <style>
        body { 
            font-family: 'Helvetica Neue', Arial, sans-serif; 
            display: flex; flex-direction: column; align-items: center; 
            background-color: #1a1a2e; color: #ffffff; padding: 20px;
            overflow-x: hidden;
        }
        h1 { margin-bottom: 5px; color: #00d4ff; text-shadow: 0 0 10px rgba(0,212,255,0.5); }
        .counter { font-size: 1.2rem; margin-bottom: 20px; color: #888; }
        
        /* ç›¤é¢ã®è¨­å®š */
        .board-container {
            position: relative;
            width: 720px; /* (50px + 10px gap) * 12 */
            height: 80px;
            margin: 40px 0;
        }
        
        .card { 
            position: absolute;
            width: 50px; height: 70px; 
            background: #252545; 
            border: 2px solid #444; border-radius: 8px;
            display: flex; justify-content: center; align-items: center; 
            font-size: 1.4rem; font-weight: bold; color: #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); /* ã‚¹ãƒ ãƒ¼ã‚ºãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            user-select: none;
        }
        
        .card.correct { border-color: #00ff88; color: #00ff88; box-shadow: 0 0 15px rgba(0,255,136,0.3); }

        .controls { margin-top: 20px; }
        button { 
            padding: 15px 35px; font-size: 1.1rem; cursor: pointer; margin: 10px; 
            border-radius: 12px; border: none; font-weight: bold;
            transition: 0.2s; color: white;
        }
        .btn-a { background: #4e54c8; }
        .btn-b { background: #ff416c; }
        button:hover:not(:disabled) { transform: translateY(-3px); filter: brightness(1.2); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }

        .status { margin-top: 20px; font-size: 1.6rem; font-weight: bold; height: 1.5em; color: #00ff88; }
    </style>
</head>
<body>

    <h1>M12 ç½®æ›ãƒ‘ã‚ºãƒ«</h1>
    <div class="counter" id="counter">Moves: 0</div>
    
    <div class="board-container" id="board">
        </div>

    <div class="controls">
        <button id="btnA" class="btn-a" onclick="applyPermutation('a')">æ“ä½œ a</button>
        <button id="btnB" class="btn-b" onclick="applyPermutation('b')">æ“ä½œ b</button>
    </div>

    <div class="status" id="status"></div>

    <script>
        const boardElement = document.getElementById('board');
        const gap = 60; // ã‚«ãƒ¼ãƒ‰ã®é–“éš”
        let moves = 0;
        
        // 1ã‹ã‚‰12ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆDOMè¦ç´ ã‚’ä¿æŒï¼‰
        let cards = [];
        for (let i = 1; i <= 12; i++) {
            const el = document.createElement('div');
            el.className = 'card';
            el.textContent = i;
            boardElement.appendChild(el);
            cards.push({ id: i, element: el });
        }

        // ç¾åœ¨ã®ã‚«ãƒ¼ãƒ‰ã®ä¸¦ã³é †ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰
        // 0ç•ªç›®ã®ä½ç½®ã«ã„ã‚‹ã®ã¯IDãŒä½•ç•ªã®ã‚«ãƒ¼ãƒ‰ã‹ã€ã‚’ç®¡ç†
        let currentOrder = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];

        // ç½®æ›ã®å®šç¾©
        const permA = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 11]; 
        const permB = [9, 4, 6, 7, 1, 8, 2, 3, 5, 0, 11, 10];

        function updateDisplay() {
            currentOrder.forEach((cardIdx, pos) => {
                const card = cards[cardIdx];
                // ä½ç½®ã‚’è¨ˆç®—ã—ã¦ç§»å‹•
                card.element.style.left = `${pos * gap}px`;
                
                // æ­£è§£ã®ä½ç½®ã«ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (card.id === pos + 1) {
                    card.element.classList.add('correct');
                } else {
                    card.element.classList.remove('correct');
                }
            });
            document.getElementById('counter').textContent = `Moves: ${moves}`;
        }

        function applyPermutation(type, isShuffling = false) {
            const p = type === 'a' ? permA : permB;
            const newOrder = new Array(12);
            
            for (let i = 0; i < 12; i++) {
                newOrder[p[i]] = currentOrder[i];
            }
            currentOrder = newOrder;
            
            if (!isShuffling) {
                moves++;
                updateDisplay();
                checkWin();
            }
        }

        function shuffle() {
            // ã‚·ãƒ£ãƒƒãƒ•ãƒ«ä¸­ã¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çŸ­ãã™ã‚‹
            cards.forEach(c => c.element.style.transition = 'none');
            for (let i = 0; i < 40; i++) {
                applyPermutation(Math.random() > 0.5 ? 'a' : 'b', true);
            }
            // å°‘ã—é…ã‚‰ã›ã¦ã‹ã‚‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æˆ»ã—ã¦è¡¨ç¤º
            setTimeout(() => {
                cards.forEach(c => c.element.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)');
                updateDisplay();
            }, 50);
        }

        function checkWin() {
            const isWin = currentOrder.every((cardIdx, pos) => cards[cardIdx].id === pos + 1);
            if (isWin && moves > 0) {
                document.getElementById('status').textContent = "ğŸ‰ CLEAR! ğŸ‰";
                document.getElementById('btnA').disabled = true;
                document.getElementById('btnB').disabled = true;
            }
        }

        // åˆæœŸåŒ–
        shuffle();
    </script>
</body>
</html>

